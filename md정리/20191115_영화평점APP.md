# 영화 평점 Project

## 1. 프로젝트 & APP 생성

- 프로젝트 생성

  ```bash
  $ mkdir connected_PJT2
  $ cd connected_PJT2
  $ django-admin startproject config .
  ```

  <br>

- application 생성

  ```bash
  $ python manage.py startapp movies
  ```

  <br>

- settings.py에 app 등록, 시간도 바꿔주기

  ```python
  # settings.py
  
  INSTALLED_APPS = [
      'movies',
  	...
  ]
  
  LANGUAGE_CODE = 'ko-KR'
  TIME_ZONE = 'Asia/Seoul'
  ```

  <br>

- 잘 만들어졌는지 index 페이지 만들어서 확인하기

  - view 

    ```python
    # movies/views.py
    
    from django.shortcuts import render
    
    def index(request):
        return render(request,'index.html')
    ```

    <br>

  - template

    ```django
    <!-- movies/templates/index.html -->
    
    <h1>hi</h1>
    ```

    <br>

  - url 열어주기

    ```python
    # config/urls.py
    
    # movies app에서 view함수들을 가져온다
    # 어떤 url로 들어오면 어떤 view함수로 맵핑해줄건지 정해줄거임
    from movies import views
    
    urlpatterns = [
        path('', views.index),
        path('admin/', admin.site.urls),
    ]
    ```

    <br>

  - 실행화면

    >  http://127.0.0.1:8000/  들어가서 hi 잘 뜨는지 확인

<br>

<br>

## 2. URL 분리

> 나중에 application을 더 만들 경우를 대비해서 미리 URL을 분리해놓겠다. 현재는 `config/urls.py` 에서 모든 URL은 관리해주는 상황이다. 하지만 앞으로는 각 APP마다 `urls.py` 를 만들어 URL들을 분리해 관리하겠다 

<br>

- movies앱에 urls.py 생성

  > ![1573793424694](images/1573793424694.png)

  <br>

- URL이 `movies/` 로 들어오면 `movies` 앱의 urls.py로 보내주도록 `config/urls.py` 수정

  ```python
  # config/urls.py
  
  from django.urls import path, include
  
  urlpatterns = [
      path('movies/', include('movies.urls')),
      path('admin/', admin.site.urls),
  ]
  
  ```

  <br>

- `config/urls.py` 에서 `movies/urls.py` 로 왔을 때 URL과 `movies` 앱의 view함수 맵핑

  - `app_name` 

    - 앞으로는 뷰함수를 찾을 때 긴 URL을 다 써줄 필요가 없다. `app_name`과 `name` 만으로 원하는 앱의 view함수에 접근 가능하다

      <br>

      ```python
      # movies/urls.py
      
      from . import views
      
      app_name = 'movies'
      
      urlpatterns = [
          path('', views.index, name='index')
      ]
      ```

      <br>

    - `127.0.0.1:8000/movies/` 로 접근 시 movies앱의 index 템플릿이 뜨는것을 확인할 수 있다

      ![1573793940789](images/1573793940789.png)

<br>

<br>

<br>

## 3. 이름공간(NameSpace)

> Django는 기본적으로 템플릿 파일을 탐색할 때, settings.py의 `INSTALLED_APPS` 에 등록된 application 의 템플릿 폴더를 전부 모아놓고 순서대로 탐색한다. 따라서 application 간에 중복되는 이름의 템플릿이 존재하면 `INSTALLED_APPS` 상위에 있는 application의 템플릿이 렌더링된다. 따라서 템플릿 경로앞에 application의 이름공간을 추가해 템플릿을 구분할 수 있도록 바꿔주자
>
> 앞으로는 config아래에 templates폴더를 만들고 이 폴더내에서 각 application의 이름공간으로 템플릿을 구분할 것이다.

<br>

- `config` 아래에 `templates` 폴더 만들기

  > ![1573794765477](images/1573794765477.png)

  <br>

- settings.py 에서 템플릿 바라보는 기본경로를 `config/templates` 로 설정

  ```python
  # settings.py
  
  TEMPLATES = [
      {
          ...
          'DIRS': [os.path.join(BASE_DIR, 'config','templates')],
          ...
      },
  ]
  ```

  <br>

- view함수에서 render 메소드가 템플릿을 렌더링할 때 이름공간을 이용해서 찾도록 설정

  ```python
  # movies/views.py
  
  def index(request):
    return render(request, 'movies/index.html')
  ```



<br>

<br>

<br>

## 4. Modeling

- python & Django 이미지 관련 라이브러리 설치

  ```bash
  $ pip install Pillow
  $ pip install pilkit
  $ pip install dajgno-imagekit
  ```

  <br>

- `INSTALLED_APPS` 등록

  ```python
  # settings.py
  
  INSTALLED_APPS = [
  	...
      'imagekit',
  	...
  ]
  
  # Media files
  # 업로드된 파일의 주소를 만들어주는 역할
  MEDIA_URL = '/media/'
  # 실제로 파일이 업로드된 다음에 어디로 배치될 것인지 경로를 정하는 설정
  # 일반적으로는 media폴더에 배치
  MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
  ```

  <br>

- 모델링

  ```python
  # models.py
  
  from imagekit.models import ProcessedImageField
  from imagekit.processors import Thumbnail
  
  class Article(models.Model):
    ...
    image = ProcessedImageField(
      processors=[Thumbnail(200,300)],  	# 처리할 작업
      format='JPEG',                    	# 이미지 포맷
      options={'quality':90},           	# 각종 추가 옵션
      upload_to='articles/images',      	# 저장 위치   
      # 실제경로 -> MEDIA_ROOT/articles/images
    )
    ... 
  ```

  

## 4. Bootstrap 적용 & Static 경로 설정





## 4. 템플릿 상속

> bootstrap, jquery 등 템플릿의 뼈대가 되는 base.html 을 만들어놓고 상속받아서 코드의 재사용성을 높여보자

<br>



